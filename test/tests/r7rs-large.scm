(import (rnrs)
	(rnrs eval)
	(srfi :64))

(define (test-library name . bindings)
  (test-assert name (eval `(let ((t #f))
			     ,@(map (lambda (b) `(set! t ,b)) bindings))
			  (environment '(only (rnrs) let set!) name))))

(test-begin "R7RS-large")

;; Red
(test-library '(scheme list) 'alist-cons)
(test-library '(scheme vector) 'vector-empty?)
(test-library '(scheme sort) 'list-sorted?)
(test-library '(scheme set) 'set 'bag)
(test-library '(scheme charset) 'char-set:ascii)
(test-library '(scheme hash-table) 'make-hash-table)
(test-library '(scheme ilist) 'ipair)
(test-library '(scheme rlist) 'make-rlist 'rlist->list 'list->rlist 'rpair?)
(test-library '(scheme ideque) 'ideque)
(test-library '(scheme text) 'text?)
(test-library '(scheme generator) 'generator)
(test-library '(scheme lseq) 'lseq?)
(test-library '(scheme stream) 'stream-null 'stream? 'stream-take)
(test-library '(scheme box) 'box?)
(test-library '(scheme list-queue) 'make-list-queue)
(test-library '(scheme ephemeron) 'ephemeron?)
(test-library '(scheme comparator) 'make-comparator)

;; Tangerine
(test-library '(scheme regex) 'regexp)
(test-library '(scheme division) 'floor/)
(test-library '(scheme fixnum) 'fx-width)
(test-library '(scheme flonum) 'flonum)
(test-library '(scheme mapping) 'mapping?)
(test-library '(scheme mapping hash) 'hashmap?)
(test-library '(scheme format) 'show)
(test-library '(scheme vector base) 'u8vector?)
(test-library '(scheme vector u8) 'u8vector?)
(test-library '(scheme vector s8) 's8vector?)
(test-library '(scheme vector u16) 'u16vector?)
(test-library '(scheme vector s16) 's16vector?)
(test-library '(scheme vector u32) 'u32vector?)
(test-library '(scheme vector s32) 's32vector?)
(test-library '(scheme vector u64) 'u64vector?)
(test-library '(scheme vector s64) 's64vector?)
(test-library '(scheme vector f32) 'f32vector?)
(test-library '(scheme vector f64) 'f64vector?)
(test-library '(scheme vector c64) 'c64vector?)
(test-library '(scheme vector c128) 'c128vector?)

(test-end)
