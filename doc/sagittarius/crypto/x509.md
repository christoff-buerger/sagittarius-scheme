[§3] X.509 library - (sagittarius crypto x509) {#sagittarius.crypto.x509}
------------------------------------------------------

The X.509 library provides X.509 certificate, CRL, CSR and some
other related operations.

###### [!Library] `(sagittarius crypto x509)`

The X.509 library, this library exports the procedures listed
below sections.

### [§4] X.509 certificate

###### [!Function] `x509-certificate?` _obj_

Returns `#t` if the given _obj_ is X.509 certificate, otherwise `#f`.

###### [!Function] `bytevector->x509-certificate` (_bv_ `bygevector?`)

Converts the given bytevector _bv_ to X.509 certificate. The bytevector
must be a valid X.509 structure otherwise an error is signalled.

###### [!Function] `read-x509-certificate` (_bin_ (and `input-port?` `binary-port?`))

Reads X.509 certificate from the given binary input port _bin_. The data
must be a valid X.509 structure otherwise an error is signalled.

###### [!Function] `x509-certificate->bytevector` (_certificate_ `x509-certificate?`)

Converts the given X.509 certificate _certificate_ to a bytevector.

###### [!Function] `write-x509-certificate` (_certificate_ `x509-certificate?`) :optional _out_

Writes the given X.509 certificate into _out_ if specified, otherwise 
`(current-output-port)`.

###### [!Function] `x509-certificate-expired?` (_certificate_ `x509-certificate?`) :optional when

Checks if the given X.509 certificate is expired on the given _when_
if specified, otherwise `(current-date)`.

###### [!Function] `x509-certificate-issuer-dn` (_certificate_ `x509-certificate?`)

Retrieves IssuerDn of the given _certificate_ as X.509 name.

###### [!Function] `x509-certificate-subject-dn` (_certificate_ `x509-certificate?`)

Retrieves SubjectDn of the given _certificate_ as X.509 name.

###### [!Function] `x509-certificate-public-key` (_certificate_ `x509-certificate?`)

Retrieves public key of the given _certificate_.

###### [!Function] `x509-certificate-validity` (_certificate_ `x509-certificate?`)

Retrieves validity of the given _certificate_ as X.509 validity.

###### [!Function] `x509-certificate-serial-number` (_certificate_ `x509-certificate?`)

Retrieves serial number of the given _certificate_.

###### [!Function] `x509-certificate-version` (_certificate_ `x509-certificate?`)

Retrieves version of the given _certificate_.  
The returning value indicates the version number, for example, 
v1 certificate then the procedure returns `1`.

###### [!Function] `x509-certificate-signature` (_certificate_ `x509-certificate?`)

Retrieves signature of the given _certificate_.  

###### [!Function] `x509-certificate-signature-algorithm` (_certificate_ `x509-certificate?`)

Retrieves signature algorithm of the given _certificate_ as X.509
algorithm identifier.

###### [!Function] `x509-certificate-extensions` (_certificate_ `x509-certificate?`)

Retrieves extensions of the given _certificate_ as a list of X.509 extension.

###### [!Function] `validate-x509-certificate` (_certificate_ `x509-certificate?`) _validator_ _..._

Validates the given _certificate_ against the given _validator_.  
_validator_ must be a procedure accepts one argument, _certificate_.

###### [!Function] `x509-certificate-signature-validator` (_public-key_ `public-key?`)

Creates a signature validator.

###### [!Function] `x509-certificate-validity-validator` :optional _when_

Creates a validity validator.  
Optional argument _when_ specifies in which period of time the certificate
validity. Default value is `(current-date)`.

###### [!Function] `x509-certificate-signed-by?` (_certificate_ `x509-certificate?`) (_ca-certificate_ `x509-certificate?`)

Returns `t` if the given _certificate_ is signed by the _ca-certificate_,
otherwise `#t`.

###### [!Function] `x509-certificate-template?` _obj_

Returns `#t` if the given _obj_ is X.509 certificate template, otherwise `#f`.

###### [!Macro] `x509-certificate-template-builder` (_field_ _value_) ...

Builds an X.509 certificate template. _field_ and its _value_ must
be one or more of the followings:

`issuer-dn`
: X.509 name, represents IssuerDn. Required.

`subject-dn`
: X.509 name, represents SubjectDn. Required.

`serial-number`
: Integer, represents serial number. Required.

`not-before`
: Date, represents not before. Required.

`not-after`
: Date, represents not after. Required.

`public-key`
: Public key of the certificate. Required.

`issuer-unique-id`
: Bytevector, represents issuer unique Id. Optional.

`subject-unique-id`
: Bytevector, represents subject unique Id. Optional.

`extentions`
: List of X.509 extensions. Optional.

###### [!Function] `sign-x509-certificate-template` (_template_ `x509-certificate-template?`) (_aid_ (or `string?` `x509-algorithm-identifier?`)) (_private-key_ `private-key?`)

Signs the given _template_ with _aid_ algorithm and _private-key_, then
returns X.509 certificate.


### [§4] X.509 CSR

x509-certification-request?
x509-certification-request-version
x509-certification-request-subject
x509-certification-request-public-key
x509-certification-request-attributes
x509-certification-request-signature
x509-certification-request-signature-algorithm
read-x509-certification-request
bytevector->x509-certification-request
x509-certification-request->bytevector
write-x509-certification-request
validate-x509-certification-request
x509-certification-request-signature-validator
	    
x509-certification-request-template?
x509-certification-request-template-builder
sign-x509-certification-request-template

make-x509-extension-request-attribute
make-x509-challenge-password-attribute
x509-attribute->x509-extension-list
*pkcs-9:channelge-password*
*pkcs-9:extenion-request*

### [§4] X.509 CRL

x509-certificate-revocation-list?
x509-certificate-revocation-list-issuer
x509-certificate-revocation-list-this-update
x509-certificate-revocation-list-next-update
x509-certificate-revocation-list-revoked-certificates
x509-certificate-revocation-list-crl-extensions
x509-certificate-revocation-list-signature-algorithm
x509-certificate-revocation-list-signature
read-x509-certificate-revocation-list
bytevector->x509-certificate-revocation-list
x509-certificate-revocation-list->bytevector
write-x509-certificate-revocation-list

x509-revoked-certificate?
make-x509-revoked-certificate
x509-revoked-certificate-serial-number
x509-revoked-certificate-revocation-date
x509-revoked-certificate-crl-entry-extensions

validate-x509-certificate-revocation-list
x509-certificate-revocation-list-signature-validator
x509-certificate-revocation-list-issuer-validator
x509-certificate-revoked?

x509-certificate-revocation-list-template?
x509-certificate-revocation-list-template-builder
sign-x509-certificate-revocation-list-template

### [§4] X.509 validity

x509-validity?
make-x509-validity
x509-validity-not-before
x509-validity-not-after

### [§4] X.509 algorithm identifier

x509-algorithm-identifier?
make-x509-algorithm-identifier
x509-algorithm-identifier-oid
x509-algorithm-identifier-parameters

### [§4] X.509 subject public key info

subject-public-key-info?
subject-public-key-info->public-key
public-key->subject-public-key-info
bytevector->subject-public-key-info
subject-public-key-info->bytevector

### [§4] X.509 extension

x509-extension?
x509-extension-id
x509-extension-critical?
x509-extension-value

*extension:authority-key-identifier*
*extension:subject-key-identifier*
*extension:key-usage*
*extension:private-key-usage-period*
*extension:certificate-policies*
*extension:policy-mappings*
*extension:subject-alt-name*
*extension:issuer-alt-name*
*extension:subject-directory-attributes*
*extension:basic-constraints*
*extension:name-constraints*
*extension:policy-constraints*
*extension:ext-key-usage*
*extension:crl-distribution-points*
*extension:inhibit-any-policy*
*extension:freshest-crl*
*extension:authority-info-access*
*extension:subject-info-access*

*extension:crl-number*
*extension:delta-crl-indicator*
*extension:issuing-distribution-point*

*extension:crl-reason*
*extension:certificate-issuer*
*extension:hold-instruction-code*
*extension:invalidity-date*

x509-extension-of

x509-general-name?
rfc822-name->general-name
dns-name->general-name
ip-address->general-name
uri->general-name
directory-name->general-name
registered-id->general-name

x509-general-names?
list->x509-general-names
x509-general-names
;; these are only for testing
x509-general-name->general-name
x509-general-names->general-names

make-x509-subject-alternative-name-extension
x509-subject-alternative-name-extension->x509-general-names
make-x509-issuer-alternative-name-extension
x509-issuer-alternative-name-extension->x509-general-names

x509-authority-key-identifier?
make-x509-authority-key-identifier
x509-authority-key-identifier-key-identifier
x509-authority-key-identifier-authority-cert-issuer
x509-authority-key-identifier-authority-cert-serial-number

make-x509-authority-key-identifier-extension
x509-authority-key-identifier-extension->x509-authority-key-identifier

make-x509-subject-key-identifier-extension
x509-subject-key-identifier-extension->subject-key-identifier

x509-key-usages 
x509-key-usages?
make-x509-key-usage-extension
x509-key-usage-extension->x509-key-usages

x509-private-key-usage-period?
make-x509-private-key-usage-period
x509-private-key-usage-period-not-before
x509-private-key-usage-period-not-after

make-x509-private-key-usage-period-extension
x509-private-key-usage-period-extension->x509-private-key-usage-period

x509-policy-qualifier-info?
x509-policy-qualifier-info-id
x509-policy-qualifier-info-qualifier
make-x509-policy-qualifier-info
x509-policy-qualifier-info->policy-qualifier-info

x509-notice-reference?
x509-notice-reference-organization
x509-notice-reference-notice-numbers
make-x509-notice-reference

x509-user-notice?
x509-user-notice-ref
x509-user-notice-explicit-text
make-x509-user-notice

x509-policy-information?
x509-policy-information-identifier
x509-policy-information-qualifiers
make-x509-policy-information
*policy-qualifier-type:cps*
*policy-qualifier-type:unotice*

make-x509-certificate-policies-extension
x509-certificate-policies-extension->x509-policy-informations

x509-basic-constraints?
make-x509-basic-constraints
x509-basic-constraints-ca?
x509-basic-constraints-path-length-constraint

make-x509-basic-constraints-extension
x509-basic-constraints-extension->x509-basic-constraints

### [§4] X.509 attribute

x509-attribute?
make-x509-attribute
x509-attribute-type
x509-attribute-values
x509-attribute-of

### [§4] Distinguished name (DN)

x509-name?
x509-name
x509-name->string
list->x509-name

name->x509-name
x509-name->name
